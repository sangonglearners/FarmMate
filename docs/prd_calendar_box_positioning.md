# 캘린더 멀티데이 일정 박스 위치 문제 해결 PRD

## 1. 문제 정의

### 1.1 현재 상황
- 농장 캘린더에서 멀티데이 일정을 표시하는 박스가 이랑 열(회색 열)을 침범하고 있음
- 박스의 왼쪽 부분이 이랑 열의 회색 배경 영역 안에 위치하여 시각적으로 침범하는 문제 발생
- 스크롤 시에도 동일한 문제가 지속적으로 발생

### 1.2 문제의 심각성
- 사용자 경험 저하: 박스가 이랑 열을 침범하여 레이아웃이 깨져 보임
- 시각적 혼란: 박스의 경계가 명확하지 않아 가독성 저하
- 일관성 부족: 스크롤 위치에 따라 박스 위치가 일관되지 않음

## 2. 요구사항

### 2.1 기능적 요구사항
- **FR-1**: 멀티데이 일정 박스는 이랑 열의 오른쪽 경계선까지만 사용되어야 함
- **FR-2**: 박스가 이랑 열(회색 영역)을 절대 침범하지 않아야 함
- **FR-3**: 스크롤 위치에 관계없이 박스 위치가 일관되게 유지되어야 함
- **FR-4**: 박스는 시작 날짜에 정확히 맞게 표시되어야 함

### 2.2 비기능적 요구사항
- **NFR-1**: 박스 위치 계산은 실시간으로 정확해야 함
- **NFR-2**: 다양한 화면 크기에서 일관된 동작을 보장해야 함
- **NFR-3**: 성능 저하 없이 부드러운 렌더링이 이루어져야 함

## 3. 기술적 분석

### 3.1 현재 구조 분석
```css
/* 이랑 열 구조 */
.w-[60px] .border-r .border-gray-200 .p-3 .bg-gray-50

/* 실제 계산된 너비 */
- 기본 너비: 60px
- 좌우 패딩: 12px (p-3 = 0.75rem)
- 오른쪽 테두리: 1px
- 총 너비: 73px
```

### 3.2 현재 박스 위치 계산
```javascript
left: `clamp(74px, calc(73px + ${startFlexUnits} * (100% - 73px) / ${totalFlexUnits}), 100%)`
```

### 3.3 문제점 식별
1. **계산 오류**: 이랑 열의 실제 너비 계산이 부정확할 수 있음
2. **CSS 렌더링**: 브라우저의 CSS 렌더링 차이로 인한 위치 오차
3. **스크롤 영향**: 스크롤 컨테이너의 위치 계산 오류

## 4. 해결 방안

### 4.1 단계별 해결 전략

#### Phase 1: 정확한 이랑 열 너비 측정
- 브라우저 개발자 도구를 사용하여 이랑 열의 실제 렌더링된 너비 측정
- 다양한 화면 크기에서의 일관성 확인

#### Phase 2: 박스 위치 계산 로직 개선
- 더 정확한 CSS 계산식 적용
- 브라우저 호환성을 고려한 fallback 추가

#### Phase 3: 테스트 및 검증
- 다양한 시나리오에서의 박스 위치 테스트
- 스크롤 동작 검증

### 4.2 기술적 구현 방안

#### 방안 A: CSS Grid 기반 재구성
```css
.calendar-grid {
  display: grid;
  grid-template-columns: 73px 1fr;
}
```

#### 방안 B: 더 정확한 위치 계산
```javascript
// 실제 DOM 요소의 너비를 측정하여 사용
const rowColumnWidth = rowColumnElement.offsetWidth;
left: `clamp(${rowColumnWidth + 1}px, calc(${rowColumnWidth}px + ${startFlexUnits} * (100% - ${rowColumnWidth}px) / ${totalFlexUnits}), 100%)`
```

#### 방안 C: CSS 변수 활용
```css
:root {
  --row-column-width: 73px;
}
```

## 5. 성공 기준

### 5.1 기능적 성공 기준
- [ ] 멀티데이 일정 박스가 이랑 열을 절대 침범하지 않음
- [ ] 박스가 시작 날짜에 정확히 맞게 표시됨
- [ ] 스크롤 시에도 일관된 위치 유지

### 5.2 시각적 성공 기준
- [ ] 박스의 왼쪽 경계가 이랑 열의 오른쪽 경계와 정확히 일치
- [ ] 모든 화면 크기에서 일관된 레이아웃
- [ ] 부드러운 애니메이션 및 전환 효과

## 6. 구현 계획

### 6.1 우선순위
1. **High**: 박스 침범 문제 해결
2. **Medium**: 위치 계산 정확도 향상
3. **Low**: 성능 최적화

### 6.2 일정
- **Day 1**: 현재 문제 정확한 분석 및 측정
- **Day 2**: 해결 방안 구현
- **Day 3**: 테스트 및 검증

## 7. 리스크 관리

### 7.1 기술적 리스크
- **브라우저 호환성**: 다양한 브라우저에서의 렌더링 차이
- **성능 영향**: 실시간 계산으로 인한 성능 저하 가능성

### 7.2 완화 방안
- CSS fallback 제공
- 성능 모니터링 및 최적화
- 다양한 환경에서의 테스트 수행
